<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Awesome Website</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f0f2f5;
      color: #333;
    }
    h1 { font-size: 1.5em; color: #1a1a1a; margin-bottom: 20px; }
    .tabs { display: flex; flex-wrap: wrap; border-bottom: 2px solid #ddd; margin-bottom: 20px; }
    .tab-button {
      padding: 10px 20px; cursor: pointer; border: none; background-color: transparent;
      font-size: 1.2em; color: #555; border-bottom: 3px solid transparent;
      transition: color 0.3s, border-color 0.3s;
    }
    .tab-button:hover { color: #007bff; }
    .tab-button.active { color: #007bff; border-bottom-color: #007bff; font-weight: 600; }
    .content-panel { display: none; animation: fadeIn 0.5s; }
    .content-panel.active { display: block; }
    .main-category { background-color: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    h2 { font-size: 1.4em; color: #333; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 25px; margin-bottom: 15px; }
    .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px; padding: 0; }
    @media (min-width: 768px) { .grid-container { grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); } }
    @media (min-width: 1600px) { .grid-container { grid-template-columns: repeat(12, 1fr); } }
    .grid-item { list-style: none; }
    .card { display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: #333; padding: 10px; background-color: #fff; border: 1px solid #e9e9e9; border-radius: 8px; transition: transform 0.2s ease, box-shadow 0.2s ease; height: 90px; text-align: center; overflow: hidden; word-break: break-all; }
    .card img { width: 32px; height: 32px; margin-bottom: 8px; }
    .card span { font-size: 12px; line-height: 1.2; }
    a.card:hover { transform: translateY(-5px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-color: #007bff; }
    .no-link { background-color: #f9f9f9; color: #888; cursor: not-allowed; }
    .no-link img { filter: grayscale(80%); }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>
<body>
  
  <h1>我的网页收藏夹</h1>
  <div id="tabs-container" class="tabs"></div>
  <div id="content-container"></div>

  <script src="bookmarks.js"></script>
  
  <script>
    // 确保在DOM加载完毕后执行
    document.addEventListener('DOMContentLoaded', () => {
      // 检查 `bookmarksData` 是否已加载
      if (typeof bookmarksData === 'undefined') {
        document.body.innerHTML = `<div class="error-message"><h2>加载失败</h2><p>未能加载书签数据 (bookmarks.js)。</p><p>请先运行 'python generate_js.py' 命令来生成该文件。</p></div>`;
        return;
      }
      buildPageFromData(bookmarksData);
    });

    function buildPageFromData(data) {
      const tabsContainer = document.getElementById('tabs-container');
      const contentContainer = document.getElementById('content-container');
      const defaultIcon = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSIjZGRkIiBkPSJNMTAgNHYyYTggOCAwIDAgMCA4IDhoMmExMCAxMCAwIDAgMS0xMCAxMFY0Wm0xMC4wMDggMi44MjhsMS40MTQgMS40MTRMMTUuNTU0IDEybDEuNDM4IDIuNzU4bC0yLjg1NyAyLjM5OEwxMyAxMy41VjExbDIuMDA4LS43MTRaTTMuOTkyIDQuMjIybC0xLjQxNCAxLjQxNEw4LjQ0NiAxMmwzLjU2MiA2LjQ2MWwyLjg1Ny0yLjM5OEw5IDEwLjVWMTNsLTIuMDA4LjcxNFoiLz48L3N2Zz4=';
      const appIcon = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cmVjdCB4PSI1IiB5PSIyIiB3aWR0aD0iMTQiIGhlaWdodD0iMjAiIHJ4PSIyIiByeT0iMiI+PC9yZWN0PjxsaW5lIHgxPSIxMiIgeTE9IjE4IiB4Mj0iMTIuMDEiIHkyPSIxOCI+PC9saW5lPjwvc3ZnPg==';
      
      data.forEach((category, index) => {
        const panelId = `panel-${index}`;
        // 创建 Tab 按钮
        const tabButton = document.createElement('button');
        tabButton.className = 'tab-button';
        tabButton.textContent = category.category;
        tabButton.setAttribute('data-target', panelId);
        tabsContainer.appendChild(tabButton);

        // 创建内容面板
        const contentPanel = document.createElement('div');
        contentPanel.id = panelId;
        contentPanel.className = 'content-panel';
        const mainCategoryDiv = document.createElement('div');
        mainCategoryDiv.className = 'main-category';
        contentPanel.appendChild(mainCategoryDiv);

        category.subsections.forEach(subsection => {
          const h2 = document.createElement('h2');
          h2.textContent = subsection.title;
          mainCategoryDiv.appendChild(h2);
          const ul = document.createElement('ul');
          ul.className = 'grid-container';
          mainCategoryDiv.appendChild(ul);

          subsection.items.forEach(item => {
            const { name, url } = item;
            const li = document.createElement('li');
            li.className = 'grid-item';
            const card = url ? document.createElement('a') : document.createElement('div');
            card.className = url ? 'card' : 'card no-link';
            if (url) { card.href = url; card.target = "_blank"; }
            const img = document.createElement('img');
            const iconSpan = document.createElement('span');
            iconSpan.textContent = name;
            card.appendChild(img);
            card.appendChild(iconSpan);
            li.appendChild(card);
            ul.appendChild(li);
            if (url) {
                try {
                    const domain = new URL(url).hostname;
                    img.src = `https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${domain}&size=64`;
                    img.onerror = () => { img.src = defaultIcon; };
                } catch (e) {
                    img.src = defaultIcon;
                }
            } else {
                img.src = name.toLowerCase().includes('app') ? appIcon : defaultIcon;
            }
          });
        });
        contentContainer.appendChild(contentPanel);
      });

      const tabs = document.querySelectorAll('.tab-button');
      const panels = document.querySelectorAll('.content-panel');
      function switchTab(targetId) {
          panels.forEach(panel => panel.classList.remove('active'));
          tabs.forEach(tab => tab.classList.remove('active'));
          const targetPanel = document.getElementById(targetId);
          const targetTab = document.querySelector(`.tab-button[data-target="${targetId}"]`);
          if (targetPanel && targetTab) {
              targetPanel.classList.add('active');
              targetTab.classList.add('active');
          }
      }
      tabs.forEach(tab => {
          tab.addEventListener('click', () => switchTab(tab.getAttribute('data-target')));
      });
      if (tabs.length > 0) {
          switchTab(tabs[0].getAttribute('data-target'));
      }
    }
  </script>

</body>
</html>